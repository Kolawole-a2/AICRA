# ATT&CK to D3FEND countermeasures mapping
# Maps MITRE ATT&CK techniques to D3FEND defensive countermeasures
__version__: "1.0.0"
__description__: "Mapping from MITRE ATT&CK techniques to D3FEND defensive countermeasures"

mappings:
  "T1486":  # Data Encrypted for Impact
    - "D3-APAL"  # Application Allowlisting
    - "D3-FCR"   # File-Content Rules
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-ANET"  # Application Network Traffic Analysis
    - "D3-BACK"  # Backup and Recovery
    - "D3-ENCR"  # Encryption
    - "D3-FILE"  # File Analysis
    - "D3-MON"   # Monitoring
    - "D3-PROT"  # Process Protection

  "T1059":  # Command and Scripting Interpreter
    - "D3-APAL"  # Application Allowlisting
    - "D3-FCR"   # File-Content Rules
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-ANET"  # Application Network Traffic Analysis
    - "D3-FILE"  # File Analysis
    - "D3-MON"   # Monitoring
    - "D3-PROT"  # Process Protection
    - "D3-SCRIPT" # Script Analysis

  "T1083":  # File and Directory Discovery
    - "D3-FILE"  # File Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation

  "T1016":  # System Network Configuration Discovery
    - "D3-NET"   # Network Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-ANET"  # Application Network Traffic Analysis

  "T1082":  # System Information Discovery
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation

  "T1057":  # Process Discovery
    - "D3-PROT"  # Process Protection
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation

  "T1049":  # System Network Connections Discovery
    - "D3-NET"   # Network Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-ANET"  # Application Network Traffic Analysis

  "T1007":  # System Service Discovery
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation

  "T1018":  # Remote System Discovery
    - "D3-NET"   # Network Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-ANET"  # Application Network Traffic Analysis

  "T1021":  # Remote Services
    - "D3-NET"   # Network Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-ANET"  # Application Network Traffic Analysis
    - "D3-AUTH"  # Authentication

  "T1071":  # Application Layer Protocol
    - "D3-NET"   # Network Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-ANET"  # Application Network Traffic Analysis
    - "D3-PROT"  # Process Protection

  "T1105":  # Ingress Tool Transfer
    - "D3-NET"   # Network Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-ANET"  # Application Network Traffic Analysis
    - "D3-FILE"  # File Analysis

  "T1041":  # Exfiltration Over C2 Channel
    - "D3-NET"   # Network Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-ANET"  # Application Network Traffic Analysis
    - "D3-DLP"   # Data Loss Prevention

  "T1489":  # Service Stop
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-PROT"  # Process Protection

  "T1490":  # Inhibit System Recovery
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-BACK"  # Backup and Recovery
    - "D3-PROT"  # Process Protection

  "T1562":  # Impair Defenses
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-PROT"  # Process Protection
    - "D3-APAL"  # Application Allowlisting

  "T1070":  # Indicator Removal
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-FILE"  # File Analysis

  "T1027":  # Obfuscated Files or Information
    - "D3-FILE"  # File Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-SCRIPT" # Script Analysis

  "T1036":  # Masquerading
    - "D3-FILE"  # File Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-AUTH"  # Authentication

  "T1055":  # Process Injection
    - "D3-PROT"  # Process Protection
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-SYS"   # System Analysis

  "T1053":  # Scheduled Task/Job
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-PROT"  # Process Protection

  "T1543":  # Create or Modify System Process
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-PROT"  # Process Protection

  "T1078":  # Valid Accounts
    - "D3-AUTH"  # Authentication
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-CRED"  # Credential Hardening

  "T1110":  # Brute Force
    - "D3-AUTH"  # Authentication
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-CRED"  # Credential Hardening

  "T1072":  # Software Deployment Tools
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-APAL"  # Application Allowlisting

  "T1076":  # Multi-Factor Authentication Request Interception
    - "D3-AUTH"  # Authentication
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-CRED"  # Credential Hardening

  "T1074":  # Data Staged
    - "D3-FILE"  # File Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-DLP"   # Data Loss Prevention

  "T1075":  # Data from Local System
    - "D3-FILE"  # File Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-DLP"   # Data Loss Prevention

  "T1079":  # Data from Network Shared Drive
    - "D3-NET"   # Network Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-ANET"  # Application Network Traffic Analysis
    - "D3-DLP"   # Data Loss Prevention

  "T1080":  # Taint Shared Content
    - "D3-FILE"  # File Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-DLP"   # Data Loss Prevention

  "T1081":  # Credentials in Files
    - "D3-FILE"  # File Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-CRED"  # Credential Hardening

  "T1084":  # Windows Management Instrumentation
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-PROT"  # Process Protection

  "T1085":  # Rundll32
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-PROT"  # Process Protection
    - "D3-APAL"  # Application Allowlisting

  "T1086":  # PowerShell
    - "D3-SCRIPT" # Script Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-PROT"  # Process Protection
    - "D3-APAL"  # Application Allowlisting

  "T1087":  # Mshta
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-PROT"  # Process Protection
    - "D3-APAL"  # Application Allowlisting

  "T1088":  # Bypass User Account Control
    - "D3-SYS"   # System Analysis
    - "D3-MON"   # Monitoring
    - "D3-BA"    # Behavioral Analytics
    - "D3-AN"    # Application Network Isolation
    - "D3-PROT"  # Process Protection
    - "D3-AUTH"  # Authentication
